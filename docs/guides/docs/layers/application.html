<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
            <title>DoDomuDojade Documentation</title>
    

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../../../">
    <link rel="icon" href="images/favicon.ico"/>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/base.css">
            <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@100;200;300;400;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.css">
                <script src="https://cdn.jsdelivr.net/npm/fuse.js@3.4.6"></script>
        <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
        <script src="js/template.js"></script>
        <script src="js/search.js"></script>
        <script defer src="js/searchIndex.js"></script>
    </head>
<body id="top">
    <header class="phpdocumentor-header phpdocumentor-section">
    <h1 class="phpdocumentor-title"><a href="" class="phpdocumentor-title__link">DoDomuDojade Documentation</a></h1>
    <input class="phpdocumentor-header__menu-button" type="checkbox" id="menu-button" name="menu-button" />
    <label class="phpdocumentor-header__menu-icon" for="menu-button">
        <i class="fas fa-bars"></i>
    </label>
    <section data-search-form class="phpdocumentor-search">
    <label>
        <span class="visually-hidden">Search for</span>
        <svg class="phpdocumentor-search__icon" width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="7.5" cy="7.5" r="6.5" stroke="currentColor" stroke-width="2"/>
            <line x1="12.4892" y1="12.2727" x2="19.1559" y2="18.9393" stroke="currentColor" stroke-width="3"/>
        </svg>
        <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
    </label>
</section>

    <nav class="phpdocumentor-topnav">
    <ul class="phpdocumentor-topnav__menu">
        </ul>
</nav>
</header>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <input class="phpdocumentor-sidebar__menu-button" type="checkbox" id="sidebar-button" name="sidebar-button" />
<label class="phpdocumentor-sidebar__menu-icon" for="sidebar-button">
    Menu
</label>
<aside class="phpdocumentor-column -three phpdocumentor-sidebar">
                    <section class="phpdocumentor-sidebar__category -namespaces">
            <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="namespaces/app.html" class="">App</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="namespaces/app-application.html" class="">Application</a>
                
            </li>
                    <li>
                <a href="namespaces/app-config.html" class="">config</a>
                
            </li>
                    <li>
                <a href="namespaces/app-console.html" class="">Console</a>
                
            </li>
                    <li>
                <a href="namespaces/app-domain.html" class="">Domain</a>
                
            </li>
                    <li>
                <a href="namespaces/app-http.html" class="">Http</a>
                
            </li>
                    <li>
                <a href="namespaces/app-infrastructure.html" class="">Infrastructure</a>
                
            </li>
            </ul>

                        </section>
                <section class="phpdocumentor-sidebar__category -packages">
            <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="packages/Application.html" class="">Application</a>
</h4>

                        </section>
            
    <section class="phpdocumentor-sidebar__category -reports">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category -indices">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="indices/files.html">Files</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -nine phpdocumentor-content">
                                        
<section class="section " id="application-layer-api-reference">
            <h1>Application Layer - API Reference</h1>

            
    <p>Warstwa Application orkiestruje logikƒô biznesowƒÖ, koordinujƒÖc interakcje miƒôdzy Presentation a Domain Layer.</p>

            <section class="section " id="struktura-application-layer">
            <h2>üìç Struktura Application Layer</h2>

            <pre><code class="language-">src/Application/
‚îú‚îÄ‚îÄ UseCase/                        # G≈Ç√≥wne scenariusze u≈ºytkownika
‚îÇ   ‚îú‚îÄ‚îÄ Announcement/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CreateAnnouncementUseCase.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ApproveAnnouncementUseCase.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RejectAnnouncementUseCase.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DeleteAnnouncementUseCase.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ListAnnouncementsUseCase.php
‚îÇ   ‚îú‚îÄ‚îÄ Word/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CreateWordUseCase.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UpdateWordUseCase.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ListWordsUseCase.php
‚îÇ   ‚îú‚îÄ‚îÄ Quote/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ... (similar structure)
‚îÇ   ‚îú‚îÄ‚îÄ User/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RegisterUserUseCase.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginUserUseCase.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UpdateUserUseCase.php
‚îÇ   ‚îî‚îÄ‚îÄ Module/
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ DataTransferObject/             # Data Transfer Objects
    ‚îú‚îÄ‚îÄ AnnouncementDTO.php
    ‚îú‚îÄ‚îÄ UserDTO.php
    ‚îú‚îÄ‚îÄ WordDTO.php
    ‚îú‚îÄ‚îÄ QuoteDTO.php
    ‚îî‚îÄ‚îÄ ...
</code></pre>

            
    <p><strong>Namespace</strong>
: <code>App\Application\</code>
</p>

            <hr />

    </section>

            <section class="section " id="use-cases">
            <h2>üé¨ Use Cases</h2>

            
    <p>Use Case reprezentuje pojedynczy, znaczƒÖcy scenariusz u≈ºytkownika.</p>

            <section class="section " id="announcement-use-cases">
            <h3>Announcement Use Cases</h3>

            <section class="section " id="createannouncementusecase">
            <h4>CreateAnnouncementUseCase</h4>

            
    <p><strong>Lokalizacja</strong>
: <code>src/Application/UseCase/Announcement/CreateAnnouncementUseCase.php</code>
</p>

            
    <p><strong>Odpowiedzialno≈õƒá</strong>
: Obs≈Çuga tworzenia nowego og≈Çoszenia</p>

            
    <p><strong>Zale≈ºno≈õci</strong>
:</p>

            <pre><code class="language-">public function __construct(
    private AnnouncementRepository $announcementRepository,
    private LoggerInterface $logger
)
</code></pre>

            
    <p><strong>Metoda Execute</strong>
:</p>

            <pre><code class="language-">public function execute(CreateAnnouncementRequest $request): AnnouncementDTO
</code></pre>

            
    <p><strong>Parametry</strong>
: <code>CreateAnnouncementRequest</code>
</p>

            

<ul>
    <li class="dash"><code>string $title</code>
 - Tytu≈Ç og≈Çoszenia</li>

    <li class="dash"><code>string $text</code>
 - Tre≈õƒá og≈Çoszenia</li>

    <li class="dash"><code>string $validUntil</code>
 - Data wyga≈õniƒôcia (ISO 8601)</li>

    <li class="dash"><code>int $userId</code>
 - ID tw√≥rcy (opcjonalnie)</li>

</ul>

            
    <p><strong>Zwraca</strong>
: <code>AnnouncementDTO</code>
 - Nowe og≈Çoszenie</p>

            
    <p><strong>Flow</strong>
:</p>

            
    
<ol>
    <li>Waliduje request (tytu≈Ç, tekst nie puste, validUntil w przysz≈Ço≈õci)</li>

    <li>Tworzy Domain Entity (Announcement)</li>

    <li>Zapisuje w Repository</li>

    <li>Zwraca DTO dla front-endu</li>

</ol>

            
    <p><strong>WyjƒÖtki</strong>
:</p>

            

<ul>
    <li class="dash"><code>AnnouncementException</code>
 - B≈ÇƒÖd biznesowy</li>

    <li class="dash"><code>ValidationException</code>
 - B≈ÇƒÖd walidacji</li>

</ul>

            
    <p><strong>U≈ºycie w Controller</strong>
:</p>

            <pre><code class="language-">class AnnouncementController {
    public function __construct(
        private CreateAnnouncementUseCase $useCase
    ) {}
    
    public function create(Request $request): Response {
        try {
            $dto = new CreateAnnouncementRequest(
                title: $request-&gt;input(&#039;title&#039;),
                text: $request-&gt;input(&#039;text&#039;),
                validUntil: $request-&gt;input(&#039;valid_until&#039;),
                userId: $request-&gt;userId // from auth
            );
            
            $result = $this-&gt;useCase-&gt;execute($dto);
            return Response::created($result);
        } catch (ValidationException $e) {
            return Response::badRequest($e-&gt;getMessage());
        }
    }
}
</code></pre>

            <hr />

    </section>

            <section class="section " id="approveannouncementusecase">
            <h4>ApproveAnnouncementUseCase</h4>

            
    <p><strong>Lokalizacja</strong>
: <code>src/Application/UseCase/Announcement/ApproveAnnouncementUseCase.php</code>
</p>

            
    <p><strong>Odpowiedzialno≈õƒá</strong>
: Zatwierdzenie og≈Çoszenia oczekujƒÖcego</p>

            
    <p><strong>Metoda Execute</strong>
:</p>

            <pre><code class="language-">public function execute(int $announcementId, int $adminId): AnnouncementDTO
</code></pre>

            
    <p><strong>Parametry</strong>
:</p>

            

<ul>
    <li class="dash"><code>int $announcementId</code>
 - ID og≈Çoszenia do zatwierdzenia</li>

    <li class="dash"><code>int $adminId</code>
 - ID admina zatwierdzajƒÖcego</li>

</ul>

            
    <p><strong>Zwraca</strong>
: <code>AnnouncementDTO</code>
 - Zatwierdzone og≈Çoszenie</p>

            
    <p><strong>Flow</strong>
:</p>

            
    
<ol>
    <li>Pobiera Announcement z Repository</li>

    <li>Sprawdza czy istnieje i ma status PENDING</li>

    <li>Wywo≈Ça <code>$announcement-&gt;approve($adminId)</code>
 (logika domenowa)</li>

    <li>Zapisuje w Repository</li>

    <li>Zwraca DTO</li>

</ol>

            
    <p><strong>WyjƒÖtki</strong>
:</p>

            

<ul>
    <li class="dash"><code>AnnouncementNotFoundException</code>
</li>

    <li class="dash"><code>AnnouncementException</code>
 - Je≈õli status nie PENDING</li>

</ul>

            <hr />

    </section>

            <section class="section " id="rejectannouncementusecase">
            <h4>RejectAnnouncementUseCase</h4>

            
    <p><strong>Lokalizacja</strong>
: <code>src/Application/UseCase/Announcement/RejectAnnouncementUseCase.php</code>
</p>

            
    <p><strong>Odpowiedzialno≈õƒá</strong>
: Odrzucenie og≈Çoszenia oczekujƒÖcego</p>

            
    <p><strong>Metoda Execute</strong>
:</p>

            <pre><code class="language-">public function execute(int $announcementId, int $adminId, string $reason): AnnouncementDTO
</code></pre>

            
    <p><strong>Parametry</strong>
:</p>

            

<ul>
    <li class="dash"><code>int $announcementId</code>
 - ID og≈Çoszenia do odrzucenia</li>

    <li class="dash"><code>int $adminId</code>
 - ID admina odrzucajƒÖcego</li>

    <li class="dash"><code>string $reason</code>
 - Pow√≥d odrzucenia (dla archiwum)</li>

</ul>

            
    <p><strong>Zwraca</strong>
: <code>AnnouncementDTO</code>
 - Odrzucone og≈Çoszenie</p>

            <hr />

    </section>

            <section class="section " id="listannouncementsusecase">
            <h4>ListAnnouncementsUseCase</h4>

            
    <p><strong>Lokalizacja</strong>
: <code>src/Application/UseCase/Announcement/ListAnnouncementsUseCase.php</code>
</p>

            
    <p><strong>Odpowiedzialno≈õƒá</strong>
: Pobranie listy aktualnych og≈Çosze≈Ñ</p>

            
    <p><strong>Metoda Execute</strong>
:</p>

            <pre><code class="language-">public function execute(ListAnnouncementsRequest $request): array
</code></pre>

            
    <p><strong>Parametry</strong>
: <code>ListAnnouncementsRequest</code>
</p>

            

<ul>
    <li class="dash"><code>int $page = 1</code>
 - Numer strony</li>

    <li class="dash"><code>int $perPage = 10</code>
 - Ilo≈õƒá na stronƒô</li>

    <li class="dash"><code>string $status = &#039;approved&#039;</code>
 - Filtr po statusie</li>

    <li class="dash"><code>bool $validOnly = true</code>
 - Czy tylko wa≈ºne</li>

</ul>

            
    <p><strong>Zwraca</strong>
: <code>array&lt;AnnouncementDTO&gt;</code>
 - Lista og≈Çosze≈Ñ</p>

            
    <p><strong>Flow</strong>
:</p>

            
    
<ol>
    <li>Buduje query z filtrami</li>

    <li>Stosuje paginacjƒô</li>

    <li>Pobiera z Repository</li>

    <li>Transformuje do DTOs</li>

    <li>Zwraca wraz z metadanymi</li>

</ol>

            <hr />

    </section>

    </section>

            <section class="section " id="user-use-cases">
            <h3>User Use Cases</h3>

            <section class="section " id="registeruserusecase">
            <h4>RegisterUserUseCase</h4>

            
    <p><strong>Lokalizacja</strong>
: <code>src/Application/UseCase/User/RegisterUserUseCase.php</code>
</p>

            
    <p><strong>Odpowiedzialno≈õƒá</strong>
: Rejestracja nowego u≈ºytkownika</p>

            
    <p><strong>Metoda Execute</strong>
:</p>

            <pre><code class="language-">public function execute(RegisterUserRequest $request): UserDTO
</code></pre>

            
    <p><strong>Parametry</strong>
: <code>RegisterUserRequest</code>
</p>

            

<ul>
    <li class="dash"><code>string $email</code>
 - Email u≈ºytkownika</li>

    <li class="dash"><code>string $password</code>
 - Has≈Ço (raw)</li>

    <li class="dash"><code>string $name</code>
 - Nazwa u≈ºytkownika</li>

    <li class="dash"><code>?string $phoneNumber</code>
 - Numer telefonu</li>

</ul>

            
    <p><strong>Zwraca</strong>
: <code>UserDTO</code>
 - Nowy u≈ºytkownik (bez has≈Ça!)</p>

            
    <p><strong>Walidacja</strong>
:</p>

            

<ul>
    <li class="dash">Email nie mo≈ºe istnieƒá</li>

    <li class="dash">Has≈Ço musi spe≈Çniaƒá wymagania</li>

    <li class="dash">Email musi byƒá wa≈ºny</li>

</ul>

            
    <p><strong>Bezpiecze≈Ñstwo</strong>
:</p>

            

<ul>
    <li class="dash">Has≈Ço zahaszowane na level Infra (SecurityService)</li>

    <li class="dash">Brak has≈Ça w response</li>

</ul>

            <hr />

    </section>

            <section class="section " id="loginuserusecase">
            <h4>LoginUserUseCase</h4>

            
    <p><strong>Lokalizacja</strong>
: <code>src/Application/UseCase/User/LoginUserUseCase.php</code>
</p>

            
    <p><strong>Odpowiedzialno≈õƒá</strong>
: Logowanie u≈ºytkownika</p>

            
    <p><strong>Metoda Execute</strong>
:</p>

            <pre><code class="language-">public function execute(LoginUserRequest $request): LoginResponse
</code></pre>

            
    <p><strong>Parametry</strong>
: <code>LoginUserRequest</code>
</p>

            

<ul>
    <li class="dash"><code>string $email</code>
 - Email</li>

    <li class="dash"><code>string $password</code>
 - Has≈Ço (raw)</li>

</ul>

            
    <p><strong>Zwraca</strong>
: <code>LoginResponse</code>
</p>

            

<ul>
    <li class="dash"><code>UserDTO $user</code>
</li>

    <li class="dash"><code>string $token</code>
 - JWT lub session token</li>

</ul>

            <hr />

    </section>

    </section>

            <section class="section " id="word-use-cases">
            <h3>Word Use Cases</h3>

            <section class="section " id="createwordusecase">
            <h4>CreateWordUseCase</h4>

            
    <p><strong>Lokalizacja</strong>
: <code>src/Application/UseCase/Word/CreateWordUseCase.php</code>
</p>

            
    <p>Tworzy nowe s≈Çowo dnia.</p>

    </section>

            <section class="section " id="listwordsusecase">
            <h4>ListWordsUseCase</h4>

            
    <p>Pobiera s≈Çowa z paginacjƒÖ.</p>

            <hr />

    </section>

    </section>

    </section>

            <section class="section " id="data-transfer-objects-dtos">
            <h2>üì¶ Data Transfer Objects (DTOs)</h2>

            
    <p>DTOs transportujƒÖ dane miƒôdzy warstwami bez logiki biznesowej.</p>

            <section class="section " id="announcementdto">
            <h3>AnnouncementDTO</h3>

            
    <p><strong>Lokalizacja</strong>
: <code>src/Application/DataTransferObject/AnnouncementDTO.php</code>
</p>

            <pre><code class="language-">final class AnnouncementDTO {
    public function __construct(
        public int     $id,
        public string  $title,
        public string  $text,
        public string  $createdAt,      // ISO 8601
        public string  $validUntil,     // ISO 8601
        public ?int    $userId,
        public string  $status,         // &#039;pending&#039;, &#039;approved&#039;, &#039;rejected&#039;
        public ?string $decidedAt,      // ISO 8601
        public ?int    $decidedBy,
    ) {}
    
    public static function fromEntity(Announcement $entity): self {
        return new self(
            id: $entity-&gt;id,
            title: $entity-&gt;title,
            text: $entity-&gt;text,
            createdAt: $entity-&gt;createdAt-&gt;format(&#039;c&#039;),
            validUntil: $entity-&gt;validUntil-&gt;format(&#039;c&#039;),
            userId: $entity-&gt;userId,
            status: $entity-&gt;status-&gt;name,
            decidedAt: $entity-&gt;decidedAt?-&gt;format(&#039;c&#039;),
            decidedBy: $entity-&gt;decidedBy,
        );
    }
}
</code></pre>

            
    <p><strong>U≈ºycie</strong>
: Transformacja Entity ‚Üí JSON Response</p>

            <pre><code class="language-">return [
    &#039;data&#039; =&gt; AnnouncementDTO::fromEntity($announcement)
];
</code></pre>

    </section>

            <section class="section " id="userdto">
            <h3>UserDTO</h3>

            
    <p><strong>Lokalizacja</strong>
: <code>src/Application/DataTransferObject/UserDTO.php</code>
</p>

            <pre><code class="language-">final class UserDTO {
    public function __construct(
        public int    $id,
        public string $email,
        public string $name,
        public ?string $phoneNumber,
        public string $role,
        // UWAGA: Nigdy nie include password!
    ) {}
    
    public static function fromEntity(User $entity): self {
        return new self(
            id: $entity-&gt;id,
            email: $entity-&gt;email,
            name: $entity-&gt;name,
            phoneNumber: $entity-&gt;phoneNumber,
            role: $entity-&gt;role,
        );
    }
}
</code></pre>

            <hr />

    </section>

    </section>

            <section class="section " id="request-objects-request-dtos">
            <h2>üèóÔ∏è Request Objects (Request DTOs)</h2>

            
    <p>Request objects enkapsulujƒÖ dane wej≈õciowe.</p>

            <section class="section " id="createannouncementrequest">
            <h3>CreateAnnouncementRequest</h3>

            <pre><code class="language-">final class CreateAnnouncementRequest {
    public function __construct(
        public string $title,
        public string $text,
        public string $validUntil,     // ISO 8601
        public ?int   $userId = null,
    ) {}
    
    public function validate(): array {
        $errors = [];
        
        if (empty($this-&gt;title)) {
            $errors[] = &quot;Title is required&quot;;
        }
        
        if (strlen($this-&gt;title) &gt; 200) {
            $errors[] = &quot;Title is too long&quot;;
        }
        
        if (empty($this-&gt;text)) {
            $errors[] = &quot;Text is required&quot;;
        }
        
        if (strlen($this-&gt;text) &gt; 5000) {
            $errors[] = &quot;Text is too long&quot;;
        }
        
        try {
            $date = new DateTimeImmutable($this-&gt;validUntil);
            if ($date &lt;= new DateTimeImmutable()) {
                $errors[] = &quot;Valid until must be in the future&quot;;
            }
        } catch (Exception $e) {
            $errors[] = &quot;Invalid date format&quot;;
        }
        
        return $errors;
    }
    
    public function isValid(): bool {
        return empty($this-&gt;validate());
    }
}
</code></pre>

            
    <p><strong>U≈ºycie w Use Case</strong>
:</p>

            <pre><code class="language-">public function execute(CreateAnnouncementRequest $request): AnnouncementDTO {
    $errors = $request-&gt;validate();
    if (!empty($errors)) {
        throw new ValidationException($errors);
    }
    
    // ... proceed
}
</code></pre>

            <hr />

    </section>

    </section>

            <section class="section " id="typowy-flow-use-case">
            <h2>üîÑ Typowy Flow Use Case</h2>

            <pre><code class="language-">HTTP Request
    ‚Üì
Controller
‚îú‚îÄ 1. Parse request ‚Üí CreateAnnouncementRequest
‚îú‚îÄ 2. Get UseCase from DI Container
‚îú‚îÄ 3. Call useCase-&gt;execute($request)
    ‚Üì
UseCase
‚îú‚îÄ 1. Validate request ($request-&gt;validate())
‚îú‚îÄ 2. Create Domain Entity (Announcement::createNew())
‚îú‚îÄ 3. Save via Repository
‚îú‚îÄ 4. Transform to DTO
‚îú‚îÄ 5. Return DTO
    ‚Üì
Controller
‚îú‚îÄ 1. Format DTO to JSON
‚îú‚îÄ 2. Return HTTP Response
    ‚Üì
HTTP Response (JSON)
</code></pre>

            <pre><code class="language-">graph TB
    A[&quot;HTTP Request&lt;br/&gt;(POST /announcements)&quot;] --&gt;|Parse| B[&quot;Controller&quot;]
    B --&gt;|Extract Data| C[&quot;Request Object&quot;]
    C --&gt;|Pass to| D[&quot;UseCase&quot;]
    D --&gt;|Validate| C
    D --&gt;|Check Entity| E[&quot;Domain Entity&quot;]
    E --&gt;|Apply Rules| F[&quot;Valid Entity&quot;]
    D --&gt;|Save| G[&quot;Repository&quot;]
    G --&gt;|SQL INSERT| H[&quot;Database&quot;]
    H --&gt;|Return| G
    G --&gt;|Return to UseCase| D
    D --&gt;|Transform| I[&quot;DTO&quot;]
    I --&gt;|Return to Controller| B
    B --&gt;|Format| J[&quot;JSON Response&quot;]
    J --&gt;|Send| K[&quot;HTTP Response&quot;]
</code></pre>

            <hr />

    </section>

            <section class="section " id="exception-handling">
            <h2>üõ°Ô∏è Exception Handling</h2>

            
    <p>Use Cases powinny zg≈Çaszaƒá wyjƒÖtki domenowe, kt√≥re sƒÖ obs≈Çugiwane na level Controllera.</p>

            <pre><code class="language-">// UseCase
try {
    $announcement = $this-&gt;repository-&gt;findById($id);
    if (!$announcement) {
        throw new AnnouncementNotFoundException();
    }
} catch (DatabaseException $e) {
    throw new AnnouncementException(&quot;Failed to fetch announcement&quot;);
}

// Controller
try {
    $dto = $this-&gt;useCase-&gt;execute($request);
    return Response::ok($dto);
} catch (AnnouncementNotFoundException $e) {
    return Response::notFound(&quot;Announcement not found&quot;);
} catch (AnnouncementException $e) {
    return Response::badRequest($e-&gt;getMessage());
} catch (ValidationException $e) {
    return Response::unprocessableEntity($e-&gt;getErrors());
} catch (Exception $e) {
    $this-&gt;logger-&gt;error($e);
    return Response::internalServerError();
}
</code></pre>

            <hr />

    </section>

            <section class="section " id="request-usecase-response-pattern">
            <h2>üìä Request ‚Üí UseCase ‚Üí Response Pattern</h2>

            <table>
                <thead>
            <tr>
                            <th>Etap</th>
                            <th>Komponenta</th>
                            <th>Format</th>
                    </tr>
        </thead>
    <tbody>
    <tr>
            <td>1</td>
            <td>HTTP Body</td>
            <td>JSON</td>
    </tr>
    <tr>
            <td>2</td>
            <td>Controller</td>
            <td>Array</td>
    </tr>
    <tr>
            <td>3</td>
            <td>Request Object</td>
            <td>Typed Object</td>
    </tr>
    <tr>
            <td>4</td>
            <td>UseCase</td>
            <td>DTO</td>
    </tr>
    <tr>
            <td>5</td>
            <td>Response</td>
            <td>JSON</td>
    </tr>
</tbody>
</table>

            <hr />

    </section>

            <section class="section " id="best-practices">
            <h2>üéì Best Practices</h2>

            <section class="section " id="do">
            <h3>‚úÖ DO</h3>

            
    
<ol>
    <li>
    <p><strong>Waliduj ka≈ºdy Request</strong>
</p>
<pre><code class="language-">$errors = $request-&gt;validate();
if (!empty($errors)) {
    throw new ValidationException($errors);
}
</code></pre>
</li>

    <li>
    <p><strong>U≈ºyj jednego Use Case na scenariusz</strong>
</p>
<pre><code class="language-">// ‚úÖ GOOD
class CreateAnnouncementUseCase { }
class ApproveAnnouncementUseCase { }

// ‚ùå BAD
class AnnouncementUseCase { // trop wiele odpowiedzialno≈õci
}
</code></pre>
</li>

    <li>
    <p><strong>Transformuj Entity do DTOs</strong>
</p>
<pre><code class="language-">$dto = AnnouncementDTO::fromEntity($entity);
return $dto;
</code></pre>
</li>

    <li>
    <p><strong>Deleguj logikƒô biznesowƒÖ do Domain</strong>
</p>
<pre><code class="language-">$announcement-&gt;approve($adminId); // Domain handles rules
</code></pre>
</li>

    <li>
    <p><strong>Obs≈Çuguj wyjƒÖtki domenowe</strong>
</p>
<pre><code class="language-">} catch (AnnouncementException $e) {
    return Response::badRequest($e-&gt;getMessage());
}
</code></pre>
</li>

</ol>

    </section>

            <section class="section " id="don-t">
            <h3>‚ùå DON&#039;T</h3>

            
    
<ol>
    <li>
    <p><strong>Nie r√≥b SQL w Use Case</strong>
</p>
<pre><code class="language-">// ‚ùå WRONG
$result = $this-&gt;pdo-&gt;query(&quot;SELECT...&quot;);
</code></pre>
</li>

    <li>
    <p><strong>Nie mieszaj logiki z r√≥≈ºnych scenariuszy</strong>
</p>
<pre><code class="language-">// ‚ùå WRONG
class AnnouncementUseCase {
    public function create() { }
    public function approve() { }
    public function list() { }
}
</code></pre>
</li>

    <li>
    <p><strong>Nie zwracaj Entity bezpo≈õrednio</strong>
</p>
<pre><code class="language-">// ‚ùå WRONG
return $entity; // Expose domain model

// ‚úÖ RIGHT
return AnnouncementDTO::fromEntity($entity);
</code></pre>
</li>

    <li>
    <p><strong>Nie pomi≈Ñ walidacji</strong>
</p>
<pre><code class="language-">// ‚ùå WRONG
public function execute($request) {
    // Assume input is valid
}

// ‚úÖ RIGHT
public function execute($request) {
    $errors = $request-&gt;validate();
    if (!empty($errors)) throw new ValidationException();
}
</code></pre>
</li>

</ol>

            <hr />

    </section>

    </section>

            <section class="section " id="use-case-checklist">
            <h2>üìö Use Case Checklist</h2>

            
    <p>Przy tworzeniu nowego Use Case pamiƒôtaj aby:</p>

            

<ul>
    <li class="dash">[ ] Unikalny scenariusz (jedna odpowiedzialno≈õƒá)</li>

    <li class="dash">[ ] Request object z walidacjƒÖ</li>

    <li class="dash">[ ] Walidacja w execute()</li>

    <li class="dash">[ ] Domain Entity creation/manipulation</li>

    <li class="dash">[ ] Repository call (save, find, etc)</li>

    <li class="dash">[ ] Exception handling</li>

    <li class="dash">[ ] DTO transformation</li>

    <li class="dash">[ ] Clear return type</li>

    <li class="dash">[ ] Unit tests</li>

    <li class="dash">[ ] Documentation</li>

</ul>

    </section>

    </section>

                            </div>
            <section data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">
    <section class="phpdocumentor-search-results__dialog">
        <header class="phpdocumentor-search-results__header">
            <h2 class="phpdocumentor-search-results__title">Search results</h2>
            <button class="phpdocumentor-search-results__close"><i class="fas fa-times"></i></button>
        </header>
        <section class="phpdocumentor-search-results__body">
            <ul class="phpdocumentor-search-results__entries"></ul>
        </section>
    </section>
</section>
        </div>
        <a href="#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <script>
        cssVars({});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.min.js"></script>
</body>
</html>
